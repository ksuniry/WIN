<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>w-04-01</title>
    
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/style.css">

</head>
<body>
    <div class="header">  
        <div class="page_head">
            <a href="#" class="btn_back">
                <i class="ico"></i>
                <span class="blind">이전페이지로</span>
            </a>
        </div>
    </div>

    <div class="container w_04_01">

        <div class="popup_wrap w_04_01">
            <div class="popup_header">
                <h2><span>자문안 실행하기</span></h2> 
                <button class="popup_close"><span>닫기</span></button>
            </div>
            <div class="popup_content">

                <div class="section">
                    <div class="section-inner">
                        <div class="section-title tooltip-wrap">
                            <!-- case 01 ~ 04 -->
                            <span>입금하기</span>
                            <p class="section-title-sub">총<span class="value">2,100</span><em class="unit">만원</em></p>
                            <i class="ico question" onclick="tooltip('tootip-01')"></i>
                            <div class="tooltip" id="tootip-01">
                                <div class="tooltip-txt">
                                    <div class="assess">
                                        <div class="assess-item">
                                            <div class="assess-item-tit">자문안 제안 금액</div>
                                            <div class="assess-item-value">
                                                <span class="value">2,500</span>
                                                <em class="unit">만원</em>
                                            </div>
                                        </div>
                                        <div class="assess-item">
                                            <div class="assess-item-tit">자문안 월적립액(누적)</div>
                                            <div class="assess-item-value">
                                                <span class="value">100</span>
                                                <em class="unit">만원</em>
                                            </div>
                                        </div>
                                            <div class="assess-item">
                                            <div class="assess-item-tit">실제 납입한 금액</div>
                                            <div class="assess-item-value">
                                                <span class="value">500</span>
                                                <em class="unit">만원</em>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="assess">
                                        <div class="assess-item">
                                            <div class="assess-item-tit">입금해야 할 합계 금액</div>
                                            <div class="assess-item-value">
                                                <span class="value">2,100</span>
                                                <em class="unit">만원</em>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- case 05
                            <span>입금하기</span>
                            <p class="section-title-sub"><span>매수주문 승인하기</span></p> -->

                            <!-- case 06 
                            <span>상품 매수 진행중</span>-->

                            <!-- case 07 
                            <span>매수주문 실패</span>-->

                            <!-- case 08 
                            <span>월적립 투자 완료</span>-->

                            <!-- case 09 
                            <span>자문안 실행 완료</span>-->

                        </div>

                        <div class="problem-box">
                            <!-- case 01 -->
                            <p class="problem-title problem-x">
                                <span>현재 입금할 총 금액은 자문안의 월적립금과 미입금한 금액을 합산합니다. 
                                    초과납입한 경우 '0'으로 표시될 수 있습니다. </span>
                            </p>
                            <div class="problem-bt-wrap">
                                <button class="bt problem-bt-color"><span>입금 계좌번호 복사</span></button>
                            </div>

                            <!-- case 02 
                            <p class="problem-title problem-x">
                                <span>일반종합계좌는 자문안에 따라 입금해야 할 전체 금액 기준으로 현재 입금할 총 금액 표시합니다. 
                                    초과납입한 경우 '0'으로 표시될 수 있습니다. </span>
                            </p>
                            <div class="problem-bt-wrap">
                                <button class="bt problem-bt-color"><span>입금 계좌번호 복사</span></button>
                            </div>-->

                            <!-- case 03 ~ 04 
                            <p class="problem-title problem-x">
                                <span>입금일이 많이 경과했습니다. <br>
                                    상기 금액을 입금하시기 바랍니다. </span>
                            </p>
                            <div class="problem-bt-wrap">
                                <button class="bt problem-bt-color"><span>입금 계좌번호 복사</span></button>
                            </div>-->

                            <!-- case 05 
                            <p class="problem-title problem-x">
                                <span>입금완료·매수주문 승인 전입니다. <br>
                                    매수주문을 승인해 주세요.</span>
                            </p>
                            <div class="problem-bt-wrap">
                                <button class="bt problem-bt-color"><span>입금 계좌번호 복사</span></button>
                            </div>-->

                            <!-- case 06 
                            <p class="problem-title problem-x">
                                <span>승인한 매수주문이 진행 중입니다. <br>
                                    완료까지 영업일 기준 2~3일 정도 걸립니다.</span>
                            </p>-->

                            <!-- case 07 
                            <p class="problem-title problem-x">
                                <span>정상적으로 처리되지 않았습니다.<br>
                                    매수주문을 다시 승인해 주세요.</span>
                            </p>
                            <div class="problem-bt-wrap">
                                <button class="bt problem-bt-color"><span>입금 계좌번호 복사</span></button>
                            </div>-->

                            <!-- case 08 ~ 09 
                            <div class="flex">
                                <p class="title"><span>월적립 투자완료</span></p>
                                <span class="date">2021-08-08</span>
                            </div>-->


                        </div>
                    </div>
                </div>
            
                <div class="section">
                    <div class="section-inner">

                        <div class="flex between">
                            <div class="breadCrumbs"> 
                                <span>일반종합계좌</span>
                            </div>
                            <p class="txt"><span>2020-04-01</span>자문</p>
                        </div>
                        <div class="account__head">
                            <div class="account__head__logo"><img src="../../images/bank_circle_logo/294.png" class="bank_ico"></div>
                            <div class="account__head__tit">
                                <p class="account__head__name">
                                    [<span class="bankName">KB증권</span>]
                                    <span class="prdName">상품이름</span>
                                </p>
                                <p class="account__head__number">
                                    <span>123456-456789-45</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-inner">
                        <div class="section-title">
                            마이머플러 제안
                        </div>

                        <div class="tab-head">
                            <ul role="tablist" class="tab-label">
                                <li class="tab-label-item"><a href="#tabPanel-1" role="tab" class="is_active">계좌이전/운용변경</a></li>
                                <li class="tab-label-item"><a href="#tabPanel-2" role="tab">포트폴리오</a></li>
                            </ul>
                        </div>
                
                        <div class="tab-panel" id="tabPanel-1" role="tabpanel">
                            
                            <div class="dots">
                                <span>계좌명 : [KB] 연금저축펀드</span><span>세액공제액 : 연간 51만원</span><span>예상 연금수령액 : 매월 119만원(80~90세)</span>
                            </div>

                            <div class="compare-wrap">
                                <div class="compare">
                                    <div class="compare-box after">
                                        <p class="compare-box-head">제안</p>
                                        <div class="compare-box-con">
                                            <div class="cp-bank">
                                                <img src="../../images/bank_circle_logo/064.png" alt="" class="bank_ico">
                                                <p class="cp-bank-name"><span>하나은행</span></p>
                                            </div>
                                            <div class="cp-list-single"> <!-- 신규일때 -->
                                                <ul class="cp-list-name">
                                                    <li class="cp-list-name-item"><span>월납입액</span></li>
                                                    <li class="cp-list-name-item"><span>납입기간</span></li>
                                                    <li class="cp-list-name-item"><span>수령개시</span></li>
                                                    <li class="cp-list-name-item"><span>수령기간</span></li>
                                                    <li class="cp-list-name-item"><strong><span>기대수익</span></strong></li>
                                                    <li class="cp-list-name-item"><strong><span>월연금액</span></strong></li>
                                                </ul>
                                                
                                                <ul class="cp-list">
                                                    <li class="cp-list-item"><span>40만원</span></li>
                                                    <li class="cp-list-item"><span>5년</span></li>
                                                    <li class="cp-list-item"><span>60세</span></li>
                                                    <li class="cp-list-item"><span>20년</span></li>
                                                    <li class="cp-list-item"><strong><span>연1.5%</span></strong></li>
                                                    <li class="cp-list-item"><strong><span>30만원</span></strong></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <p class="txt_2x has_ico"><i class="ico lamp"></i>기대효과</p>
                            <div class="dots">
                                <span>투자(운용)기간 : 33년 (연금수령전까지 남은기간)</span>
                                <span>장기투자에 따른 위험 감소 및 기대수익률 상승 효과</span>
                            </div>
                            
                        </div>
                
                        <div class="tab-panel" id="tabPanel-2" role="tabpanel">
                            <div class="compare-wrap compare-chart">
                                <div class="compare">
                                    <div class="compare-box after">
                                        <p class="compare-box-head">제안</p>
                                        <div class="compare-box-con">
                                        
                                            <div class="chart_circle">
                                                <canvas id="myCircle" width="85px" height="85px"></canvas>
                                                <div class="circle_value">
                                                    <p><span>투자기간</span></p>
                                                    <strong><span>3년</span></strong>
                                                </div> 
                                            </div>

                                            <div class="cp-list-single"> <!-- 신규일때 -->     
                                                <ul class="cp-list-name">
                                                    <li class="cp-list-name-item"><strong><span>주식</span></strong></li>
                                                    <li class="cp-list-name-item"><strong><span>채권</span></strong></li>
                                                    <li class="cp-list-name-item"><strong><span>현금</span></strong></li>
                                                </ul>
                                                <ul class="cp-list">
                                                    <li class="cp-list-item"><span class="bold">28%</span></li>
                                                    <li class="cp-list-item"><span class="bold">28%</span></li>
                                                    <li class="cp-list-item"><span class="bold">28%</span></li>
                                                </ul>
                                            </div>
                                            
                                        </div>
                                    </div>
                                
                                </div>
                            </div>

                            <div class="box">
                                <p class="box-gradient-title">제안 포트폴리오<span class="cnt">3</span></p>

                                <div class="fund-wrap">
                                    <ul class="fund">
                                        <li class="fund-item">
                                            <div class="fund-item-head">
                                                <div class="fund-item-kind">
                                                    <span class="fund-label">펀드</span>
                                                    <span class="fund-type">국내주식형</span>
                                                </div>
                                                
                                                <div class="fund-item-percent">
                                                    <span class="percent-name">비중</span>
                                                    <span class="percent-value">21%</span>
                                                </div>
                                            </div>
                                            <p class="fund-item-name link">
                                                <span class="title">미래에셋 고배당 포커스 증권자투자 신1호(주식) AE 임</span>
                                                <i class="ico arr_right"></i>
                                            </p>
                                        </li>
                                        <li class="fund-item">
                                            <div class="fund-item-head">
                                                <div class="fund-item-kind">
                                                    <span class="fund-label">펀드</span>
                                                    <span class="fund-type">국내주식형</span>
                                                </div>
                                                
                                                <div class="fund-item-percent">
                                                    <span class="percent-name">비중</span>
                                                    <span class="percent-value">21%</span>
                                                </div>
                                            </div>
                                            <p class="fund-item-name link">
                                                <span class="title">미래에셋 고배당 포커스 증권자투자 신1호(주식) AE 임</span>
                                                <i class="ico arr_right"></i>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>

        

    </div>

    <script src="../../js/jquery-1.9.1.min.js"></script>
    <script src="../../js/chart.v2.9.4.js"></script>
      
    <script>
        $(document).ready(function(){
         
            //tooltip
            $('.tooltip').click(function(){
                $(this).removeClass('show');
            });
    
            //Tab
            $('.tab-label-item:nth-child(1) a').addClass('is_active');
            $('#tabPanel-1').show();

            $(".tab-label-item a").on("click", function(e){
                e.preventDefault();

                //label
                var target = $(this).attr("href");
                $(".tab-label-item a").removeClass("is_active");
                $(this).addClass("is_active");

                //panel
                $(".tab-panel").hide();
                $(target).show();
            });
        });

        function tooltip(toastId) {
            $(`#${toastId}`).toggleClass('show');
        }

        Chart.pluginService.register({
            afterUpdate: function (chart) {
                    var a=chart.config.data.datasets.length -1;
                    for (let i in chart.config.data.datasets) {
                        for(var j = chart.config.data.datasets[i].data.length - 1; j>= 0;--j) { 
                            if (Number(j) == (chart.config.data.datasets[i].data.length - 1))
                                continue;
                            var arc = chart.getDatasetMeta(i).data[j];
                            arc.round = {
                                x: (chart.chartArea.left + chart.chartArea.right) / 2,
                                y: (chart.chartArea.top + chart.chartArea.bottom) / 2,
                                radius: chart.innerRadius + chart.radiusLength / 2 + (a * chart.radiusLength),
                                thickness: chart.radiusLength / 2,
                                thickness: (chart.outerRadius - chart.innerRadius) / 2,
                                backgroundColor: arc._model.backgroundColor
                            }
                        }
                        a--;
                    }
            },

            afterDraw: function (chart) {
                    var ctx = chart.chart.ctx;
                    for (let i in chart.config.data.datasets) {
                        for(var j = chart.config.data.datasets[i].data.length - 1; j>= 0;--j) { 
                            if (Number(j) == (chart.config.data.datasets[i].data.length - 1))
                                continue;
                            var arc = chart.getDatasetMeta(i).data[j];
                            var startAngle = Math.PI / 2 - arc._view.startAngle;
                            var endAngle = Math.PI / 2 - arc._view.endAngle;

                            ctx.save();
                            ctx.translate(arc.round.x, arc.round.y);
                            console.log(arc.round.startAngle)
                            ctx.fillStyle = arc.round.backgroundColor;
                            ctx.beginPath();
                            ctx.arc(arc.round.radius * Math.sin(startAngle), arc.round.radius * Math.cos(startAngle), arc.round.thickness, 0, 2 * Math.PI);
                            ctx.arc(arc.round.radius * Math.sin(endAngle), arc.round.radius * Math.cos(endAngle), arc.round.thickness, 0, 2 * Math.PI);
                            ctx.closePath();
                            ctx.fill();
                            ctx.restore();
                        }
                    }
            },
        });

        
            // draw options
            var options3 ={
                maintainAspectRatio: false,
                cutoutPercentage: 80,
                legend: {
                    display: false,
                },
                tooltips: {
                    enabled: false
                },
                layout: {
                    padding: {
                        left: 0,
                        right: 0,
                        top: 0,
                        bottom: 0
                    }
                },
                elements: {
                    arc: {
                        roundedCornersFor: 0
                    }
                }
            }

            var selectBgColor = 'rgb(40, 209, 80)';
            var selectBgColor2 = 'rgb(253, 242, 106)';
            var selectBgColor3 = 'rgb(255 , 149 , 43)'; // 21-06-14 수정

            //data2
            var data2={
                labels: ['주식'],
                datasets: [{
                label: '# of Votes',
                data: [30,10,60], // 21-06-14 수정
                backgroundColor: [
                    selectBgColor,
                    selectBgColor2,
                    selectBgColor3 // 21-06-14 수정


                ],
                borderWidth:0,
                hoverBackgroundColor:[
                    selectBgColor,
                    selectBgColor2,
                    selectBgColor3 // 21-06-14 수정
                ]
            }]
            }

            //data3
            var data3={
                labels: ['주식'],
                datasets: [{
                label: '# of Votes',
                data: [40,40,20], // 21-06-14 수정
                backgroundColor: [
                    selectBgColor,
                    selectBgColor2,
                    selectBgColor3 // 21-06-14 수정
                ],
                borderWidth:0,
                hoverBackgroundColor:[
                    selectBgColor,
                    selectBgColor2,
                    selectBgColor3 // 21-06-14 수정
                ]
            }]
            }

            var ctx2 = document.getElementById('myCircle').getContext('2d');
            new Chart(ctx2, {
                type :'doughnut',
                data : data2,
                options : options3
            });

            var ctx3 = document.getElementById('myCircle2').getContext('2d');
            new Chart(ctx3, {
                type :'doughnut',
                data : data3,
                options : options3
            });
    </script>

</body>
</html>